1 CLS 
10 ? "    "
20 ? "  1000   "
30 READ U%
40 DIM A!(U%,U%),L!(U%,U%)
50 FOR I%=1TO U%
60 FOR J%=1TO U%
70 READ A!(I%,J%)
75 NEXT J%
80 READ A!(I%,0)
85 NEXT I%
90 GOSUB 9000
100 FOR I%=1TO U%
110 ? "N","X" 
120 FOR I%=1 TO U%
130 ? I%,A!(I%,0)
140 NEXT I%
150 END 
1000 REM  
1010 DATA 3
1020 REM  
1030 DATA 3,2,1,4
1040 DATA 1,1,-1,1
1050 DATA 1,-2,1,3
9000 REM /    LU-
9010 FOR I%=1TO U%
9020 L!(I%,1)=A!(I%,1)
9030 FOR J%=2TO I%
9040 L!(I%,J%)=A!(I%,J%)
9050 FOR K%=1TO J%-1
9060 L!(I%,J%)=L!(I%,J%)-L!(I%,K%)*L!(K%,J%)
9070 NEXT K%
9080 NEXT J%
9090 IF I%=U%TH9180
9100 FOR J%=I%+1TO U%
9110 L!(I%,J%)=A!(I%,J%)
9120 IF I%=1TH9160
9130 FOR K%=1TO I%-1
9140 L!(I%,J%)=L!(I%,J%)-L!(K%,J%)*L!(I%,K%)
9150 NEXT K%
9160 L!(I%,J%)=L!(I%,J%)/L!(I%,I%)
9170 NEXT J%
9180 NEXT I%
9190 FOR I%=1TO U%
9200 IF I%=1TH9240
9210 FOR J%=1TO I%-1
9220 A!(I%,0)=A!(I%,0)-A!(J%,0)*L!(I%,J%)
9230 NEXT J%
9240 A!(I%,0)=A!(I%,0)/L!(I%,I%)
9250 NEXT I%
9260 FOR I%=U%-1TO1ST-1
9270 FOR J%=U%TO I%+1ST-1
9280 A!(I%,0)=A!(I%,0)-A!(J%,0)*L!(I%,J%)
9290 NEXT J%
9300 NEXT I%
9310 RETURN 
