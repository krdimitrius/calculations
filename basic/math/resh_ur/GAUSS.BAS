5200 FOR TT%=1TO U%-1
5210 IF A!(TT%,TT%)<>0TH5330
5220 FOR TI%=TT%+1TO U%
5230 IF A!(TI%,TT%)=0TH5290
5240 FOR J1%=1TO U%
5250 L!=A!(TT%,J1%)
5260 A!(TT%,J1%)=A!(TI%,J1%)
5270 A!(TI%,J1%)=L!
5280 NEXT J1%
5290 NEXT TI%
5300 L!=A!(TT%,0)
5310 A!(TT%,0)=A!(U%,0)
5320 A!(U%,0)=L!
5330 G!(TT%)=A!(TT%,0)/A!(TT%,TT%)
5340 FOR I%=TT%+1TO U%
5350 A!(I%,0)=A!(I%,0)-A!(I%,TT%)*G!(TT%)
5360 FOR J1%=TT%TO U%
5370 J%=U%-J1%+TT%
5380 C!(TT%,J%)=A!(TT%,J%)/A!(TT%,TT%)
5390 A!(I%,J%)=A!(I%,J%)-A!(I%,TT%)*C!(TT%,J%)
5400 NEXT J1%
5410 NEXT I%
5420 NEXT TT%
5430 TI%=U%
5440 X!(TI%)=A!(TI%,0)/A!(TI%,TI%)
5450 TI%=TI%-1
5460 M!=0
5470 FOR TT%=TI% TO U%-1
5480 M!=M!+C!(TI%,TT%+1)*X!(TT%+1)
5490 NEXT TT%
5500 X!(TI%)=G!(TI%)-M!
5510 IF TI%>1TH5450
5520 RETURN 
