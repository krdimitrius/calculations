10 PRINT "  "
20 PRINT "-  F(X,Y)"
30 INPUT "    ";M
35 M=M-1
40 INPUT "  ";N
41 N=N-1
45 DIM F(N,M)
50 INPUT "X0,Y0 ";A,B
60 INPUT "    Y ";H,L
70 FOR I=0 TO N
75 FOR J=0 TO M
80 PRINT "Y"I","J;
85 INPUT F(I,J)
90 NEXT J
95 NEXT I
100 INPUT "X,Y ";X,Y
105 GOSUB 4000
110 PRINT "F("X","Y")="Z
115 GOTO 100
4000 J=INT((X-A)/H)'.F(X,Y)
4005 IF J=0 THEN J=1
4020 I=INT((Y-B)/L)
4025 IF I=0 THEN I=1
4030 P=(X-A-J*H)/H
4035 Q=(Y-B-I*L)/L
4040 I=I-1
4041 GOSUB 4080
4045 C=Z
4050 I=I+2
4051 GOSUB 4080
4055 E=Z
4060 I=I-1
4061 GOSUB 4080
4065 D=Z
4070 Z=Q*(Q-1)*C/2+(1-Q*Q)*D+Q*(Q+1)*E/2
4075 RETURN 
4080 Z=P*(P-1)*F(I,J-1)/2+(1-P*P)*F(I,J)
4090 Z=Z+P*(P+1)*F(I,J+1)/2
4095 RETURN 
